
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Plotting in SunPy &#8212; SunPy v0.8.dev8694</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.8.dev8694',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/version.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Units and Coordinates in SunPy" href="units-coordinates.html" />
    <link rel="prev" title="Spectra" href="data_types/spectra.html" /><!-- Facebook OpenGraph -->
    <meta property="og:title" content="Plotting in SunPy | SunPy v0.8.dev8694" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="/guide/plotting.html" />
    <meta property="og:image" content="/_static/img/sunpy_icon.svg" />
    <meta property="og:description" content="" />
    <meta property="og:site_name" content="SunPy v0.8.dev8694" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  </head>
  <body role="document">


<div id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div class="container">
	  <div class="navbar-header">
	    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
	      <span class="icon-bar"></span>
	      <span class="icon-bar"></span>
	      <span class="icon-bar"></span>
	    </button>
	    <a class="navbar-brand" href="http://sunpy.org">SunPy</a>
	    <span class="navbar-text navbar-version pull-left"><b></b></span>
	  </div>
	  <div class="collapse navbar-collapse nav-collapse">
	    <ul class="nav navbar-nav">
		    
		    <div class="collapse navbar-collapse nav-collapse">
			    <ul class="nav navbar-nav navbar-left">
			    	<li class="dropdown">
			    	 <a role="button" id="dLabelGlobalToc" data-toggle="dropdown" data-target="#" href="#">About<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="dropdown-submenu">
                  <a href="https://duygukeskek.github.io/sunpy-website/about.html">About</a>
                </li>
                <li class="dropdown-submenu">
                  <a href="https://duygukeskek.github.io/sunpy-website/about.html#acknowledging-sunpy">Acknowledge</a>
            		</li>
            		<li class="dropdown-submenu">
                  <a href="https://github.com/sunpy/sunpy/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a>
            		</li>
              </ul>              
			      </li>
			      <li><a href="https://duygukeskek.github.io/sunpy-website/blog.html">Blog</a></li>
			      <li class="dropdown">
			    	 <a role="button" id="dLabelGlobalToc" data-toggle="dropdown" data-target="#" href="#">Documentation<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="dropdown-submenu">
                  <a href="http://sunpy.org/sunpy-sphinx-theme/index.html">SunPy</a>
                </li>
                <li class="dropdown-submenu">
                  <a href="http://docs.sunpy.org/projects/irispy/en/latest/">IRISPy</a>
            		</li>
            		<li class="dropdown-submenu">
                  <a href="http://docs.sunpy.org/projects/solarbextrapolation/en/latest/">SolarBExtrapolation</a>
            		</li>
            		<li class="dropdown-submenu">
                  <a href="http://docs.sunpy.org/projects/sunkit-sst/en/latest/index.html">sunkit-sst</a>
            		</li>
              </ul>              
			      </li>
			      <li><a href="../index.html">Documentation</a></li>
       	        <div class="social-links">
        			<a href="https://twitter.com/share" class="twitter-share-button" data-via="sunpyproject">Tweet</a>
				    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        	        <iframe src="https://ghbtns.com/github-btn.html?user=sunpy&repo=sunpy&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
        	       </div>
	        	
	    	
	        </ul>
	    </div>	    
      </ul>
	  </div>
  </div>
</div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">

    <p class="doc-title">
        <a style="padding-left: 0" href="../index.html">SunPy 0.8.dev8694</a>
    </p>
    <form class="navbar-form navbar-right" action="../search.html" method="get">
        <div class="form-group">
            <input type="text" name="q" class="form-control" placeholder="Search" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
    <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">SunPy User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation/index.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour.html">A brief tour of SunPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="acquiring_data/index.html">Acquiring Data with SunPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_types/index.html">Data Types in SunPy</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting in SunPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="units-coordinates.html">Units and Coordinates in SunPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="time.html">Time in SunPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="roi.html">Region of Interest</a></li>
<li class="toctree-l2"><a class="reference internal" href="customization.html">Customizing SunPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code_ref/index.html">Code Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generated/gallery/index.html">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/index.html">Developer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testingfeatures.html">Testing new features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">Reporting Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ssw.html">SSWIDL/SunPy Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Full Changelog</a></li>
</ul>


        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="plotting-in-sunpy">
<span id="plotting"></span><h1>Plotting in SunPy<a class="headerlink" href="#plotting-in-sunpy" title="Permalink to this headline">¶</a></h1>
<p>SunPy makes use of <a class="reference external" href="http://matplotlib.org/">matplotlib</a> for all of its
plotting - as such, it tries to follow the matplotlib plotting philosophy. It is
therefore useful to go over how matplotlib works as background.</p>
<div class="section" id="matplotlib-tutorial">
<h2>1. Matplotlib Tutorial<a class="headerlink" href="#matplotlib-tutorial" title="Permalink to this headline">¶</a></h2>
<p>The tutorial provided here is a summary of one that can be found in the <a class="reference external" href="http://matplotlib.org/faq/usage_faq.html">matplotlib
usage documentation</a>.</p>
<p>Matplotlib provides two main pathways for plotting. One is meant for interactive use
(e.g. command-line) and the other for non-interactive use (e.g. modules). It is important
to recognize though that the interactive-use pathway (referred to as pyplot) just
provides shortcuts for doing many of the more advanced non-interactive functions in the
background. It is therefore possible to switch between the two as necessary and
it is possible to use pyplot in a non-interactive way. In this manner pyplot
is just a shortcut to making it quicker to set up plot axes and figures.
In order to get access to the full interactive capabilities of pyplot it is
necessary to turn this feature on.
Pylab is another matplotlib usage scenario but it is essentially just pyplot with the
interactive capabilities turned on and numpy and matplotlib imported into the main
namespace.</p>
</div>
<div class="section" id="pyplot">
<h2>2. Pyplot<a class="headerlink" href="#pyplot" title="Permalink to this headline">¶</a></h2>
<p>Here is a simple example of pyplot usage.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;A simple Plot&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guide/plotting-1.py">Source code</a>, <a class="reference external" href="../guide/plotting-1.png">png</a>, <a class="reference external" href="../guide/plotting-1.hires.png">hires.png</a>, <a class="reference external" href="../guide/plotting-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/plotting-1.png" src="../_images/plotting-1.png" />
</div>
<p>The <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">show</span></code></a> command opens a plot on the screen and blocks
execution until the plot window is closed. The <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">show</span></code></a>
command only works once. If you were to call <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">show</span></code></a> again
after the above code is executed nothing happens. This confusing behavior
is something that the matplotlib devs get complaints about often and so this may change.
A discussion about this can be found <a class="reference external" href="http://stackoverflow.com/questions/5524858/matplotlib-show-doesnt-work-twice">here</a>.
Don&#8217;t be confused by another command called <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.draw" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">draw</span></code></a>.
This is only used while in interactive mode.</p>
<p>To turn on interactivity for pyplot use the command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>   
</pre></div>
</div>
<p>In interactive mode, the plot will appear at the first <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a>
command and most commands will update the plot as you call them. Here is some
example code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>   
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simple Plot&quot;</span><span class="p">)</span>   
</pre></div>
</div>
<p>In this example, you&#8217;ll see that the title appears right on the plot when you call it.
Note that in this case the <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">show</span></code></a> command is useless as the
plot shows up right when you create it. Also note that some commands will not
automatically update the plot and you have to use the <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.draw" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">draw</span></code></a>
command. The following command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>   
</pre></div>
</div>
<p>turns off interactivity.</p>
</div>
<div class="section" id="advanced-pyplot">
<h2>3. Advanced Pyplot<a class="headerlink" href="#advanced-pyplot" title="Permalink to this headline">¶</a></h2>
<p>If you need more fine-grained control over plots the recommended path is to use pyplot
and access the figures and axes objects. This is shown in the following example.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guide/plotting-2.py">Source code</a>, <a class="reference external" href="../guide/plotting-2.png">png</a>, <a class="reference external" href="../guide/plotting-2.hires.png">hires.png</a>, <a class="reference external" href="../guide/plotting-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/plotting-2.png" src="../_images/plotting-2.png" />
</div>
<p>In matplotlib, <a class="reference external" href="http://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">Figure</span></code></a> is the top-level container for all plot elements and
<a class="reference external" href="http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">Axes</span></code></a> is the top-level container for a particular plot. So the above example,
creates a figure then creates an axes and populates the plot in <code class="docutils literal"><span class="pre">ax</span></code>. With this method you
now have your hands on the <a class="reference external" href="http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">Axes</span></code></a> object so you can do things
like change the labels on the x and y axes or add a legend.
In the previous section, pyplot took care of creating these
objects for you so you didn&#8217;t have to worry about creating them yourself.</p>
</div>
<div class="section" id="sunpy-plotting-convention">
<h2>4. SunPy Plotting Convention<a class="headerlink" href="#sunpy-plotting-convention" title="Permalink to this headline">¶</a></h2>
<p>To be consistent with matplotlib, SunPy has developed a standard plotting policy
which supports both simple and advanced matplotlib usage. The following examples
focus on the map object but they should be applicable across all of the data
objects.</p>
</div>
<div class="section" id="peek">
<h2>4.1 peek()<a class="headerlink" href="#peek" title="Permalink to this headline">¶</a></h2>
<p>For quick and easy access to a plot all SunPy base objects (i.e. maps, spectra,
timeseries) define their own <a class="reference internal" href="../code_ref/map.html#sunpy.map.mapbase.GenericMap.peek" title="sunpy.map.mapbase.GenericMap.peek"><code class="xref py py-obj docutils literal"><span class="pre">peek</span></code></a> command which
will create a plot for you and show it without you having to deal with any
matplotlib setup. This is so that it is easy to take a quick look at your data.
For example you can make the following plot.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sunpy.map</span>
<span class="kn">import</span> <span class="nn">sunpy.data.sample</span>
<span class="n">smap</span> <span class="o">=</span> <span class="n">sunpy</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">sunpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">AIA_171_IMAGE</span><span class="p">)</span>
<span class="n">smap</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="n">draw_limb</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guide/plotting-3.py">Source code</a>, <a class="reference external" href="../guide/plotting-3.png">png</a>, <a class="reference external" href="../guide/plotting-3.hires.png">hires.png</a>, <a class="reference external" href="../guide/plotting-3.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/plotting-3.png" src="../_images/plotting-3.png" />
</div>
<p>This creates a plot window with all axes defined, a plot title, and the image of
the map data defined by the contents of the map. In non-interactive mode the
plot window blocks the command line terminal and must be closed before doing anything else.</p>
</div>
<div class="section" id="plot">
<h2>4.2 plot()<a class="headerlink" href="#plot" title="Permalink to this headline">¶</a></h2>
<p>For more advanced plotting the base SunPy objects also provide a
<a class="reference internal" href="../code_ref/map.html#sunpy.map.mapbase.GenericMap.plot" title="sunpy.map.mapbase.GenericMap.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a> command. This command is similar to the
pyplot <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">imshow</span></code></a> command in that it will create a figure and
axes object for you if you haven&#8217;t already.</p>
<p>When you create a plot with <a class="reference internal" href="../api/sunpy.map.GenericMap.html#sunpy.map.GenericMap.peek" title="sunpy.map.GenericMap.peek"><code class="xref py py-obj docutils literal"><span class="pre">peek</span></code></a> or
<a class="reference internal" href="../api/sunpy.map.GenericMap.html#sunpy.map.GenericMap.plot" title="sunpy.map.GenericMap.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a>, SunPy will use <a class="reference external" href="http://docs.astropy.org/en/stable/visualization/wcsaxes/index.html#module-astropy.visualization.wcsaxes" title="(in Astropy v2.0.1)"><code class="xref py py-obj docutils literal"><span class="pre">astropy.visualization.wcsaxes</span></code></a> to
represent coordinates on the image accurately, for more information see
<a class="reference internal" href="#wcsaxes-plotting"><span class="std std-ref">Plotting Maps with wcsaxes</span></a>.</p>
<p>Using <a class="reference internal" href="../api/sunpy.map.GenericMap.html#sunpy.map.GenericMap.plot" title="sunpy.map.GenericMap.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a> it is possible to customise the look of the
plot by combining SunPy and matplotlib commands, for example you can over plot
contours on the Map:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>

<span class="kn">import</span> <span class="nn">sunpy.map</span>
<span class="kn">import</span> <span class="nn">sunpy.data.sample</span>

<span class="n">aia_map</span> <span class="o">=</span> <span class="n">sunpy</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">sunpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">AIA_171_IMAGE</span><span class="p">)</span>
<span class="n">aia_map</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">aia_map</span><span class="o">.</span><span class="n">draw_limb</span><span class="p">()</span>

<span class="c1"># let&#39;s add contours as well</span>
<span class="n">aia_map</span><span class="o">.</span><span class="n">draw_contours</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">percent</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guide/plotting-4.py">Source code</a>, <a class="reference external" href="../guide/plotting-4.png">png</a>, <a class="reference external" href="../guide/plotting-4.hires.png">hires.png</a>, <a class="reference external" href="../guide/plotting-4.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/plotting-4.png" src="../_images/plotting-4.png" />
</div>
<p>In this example, the <a class="reference external" href="http://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">Figure</span></code></a> and
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="(in Astropy v2.0.1)"><code class="xref py py-obj docutils literal"><span class="pre">WCSAxes</span></code></a> instances are created explicitly, and
then used to modify the plot:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>

<span class="kn">import</span> <span class="nn">sunpy.map</span>
<span class="kn">import</span> <span class="nn">sunpy.data.sample</span>

<span class="n">smap</span> <span class="o">=</span> <span class="n">sunpy</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">sunpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">AIA_171_IMAGE</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Provide the Map as a projection, which creates a WCSAxes object</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">smap</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">smap</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Prevent the image from being re-scaled while overplotting.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_autoscale_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="n">xc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>
<span class="n">yc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>

<span class="n">coords</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">smap</span><span class="o">.</span><span class="n">coordinate_frame</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_coord</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="c1"># Set title.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Custom plot with WCSAxes&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guide/plotting-5.py">Source code</a>, <a class="reference external" href="../guide/plotting-5.png">png</a>, <a class="reference external" href="../guide/plotting-5.hires.png">hires.png</a>, <a class="reference external" href="../guide/plotting-5.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/plotting-5.png" src="../_images/plotting-5.png" />
</div>
<p>It is possible to create the same plot, explicitly not using
<a class="reference external" href="http://docs.astropy.org/en/stable/visualization/wcsaxes/index.html#module-astropy.visualization.wcsaxes" title="(in Astropy v2.0.1)"><code class="xref py py-obj docutils literal"><span class="pre">wcsaxes</span></code></a>, however, this will not have the features of
<a class="reference external" href="http://docs.astropy.org/en/stable/visualization/wcsaxes/index.html#module-astropy.visualization.wcsaxes" title="(in Astropy v2.0.1)"><code class="xref py py-obj docutils literal"><span class="pre">wcsaxes</span></code></a> which include correct representation of
rotation and plotting in different coordinate systems.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>

<span class="kn">import</span> <span class="nn">sunpy.map</span>
<span class="kn">import</span> <span class="nn">sunpy.data.sample</span>

<span class="n">smap</span> <span class="o">=</span> <span class="n">sunpy</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">sunpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">AIA_171_IMAGE</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">smap</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Prevent the image from being re-scaled while overplotting.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_autoscale_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="n">xc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>
<span class="n">yc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="c1"># Set title.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Custom plot without WCSAxes&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guide/plotting-6.py">Source code</a>, <a class="reference external" href="../guide/plotting-6.png">png</a>, <a class="reference external" href="../guide/plotting-6.hires.png">hires.png</a>, <a class="reference external" href="../guide/plotting-6.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/plotting-6.png" src="../_images/plotting-6.png" />
</div>
</div>
<div class="section" id="plotting-maps-with-wcsaxes">
<span id="wcsaxes-plotting"></span><h2>Plotting Maps with wcsaxes<a class="headerlink" href="#plotting-maps-with-wcsaxes" title="Permalink to this headline">¶</a></h2>
<p>By default <a class="reference internal" href="../code_ref/map.html#map"><span class="std std-ref">SunPy map</span></a> uses the <a class="reference external" href="http://docs.astropy.org/en/stable/visualization/wcsaxes/index.html#module-astropy.visualization.wcsaxes" title="(in Astropy v2.0.1)"><code class="xref py py-obj docutils literal"><span class="pre">astropy.visualization.wcsaxes</span></code></a> module to improve
the representation of world coordinates, and calling
<a class="reference internal" href="../api/sunpy.map.GenericMap.html#sunpy.map.GenericMap.plot" title="sunpy.map.GenericMap.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a> or <a class="reference internal" href="../api/sunpy.map.GenericMap.html#sunpy.map.GenericMap.peek" title="sunpy.map.GenericMap.peek"><code class="xref py py-obj docutils literal"><span class="pre">peek()</span></code></a> will use wcsaxes
for plotting. Unless a standard <a class="reference external" href="http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.0.2)"><code class="xref py py-obj docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> object is explicitly
created.</p>
<p>To explicitly create a <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="(in Astropy v2.0.1)"><code class="xref py py-obj docutils literal"><span class="pre">WCSAxes</span></code></a> instance do the
following</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>   
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">smap</span><span class="p">)</span>   
</pre></div>
</div>
<p>when plotting on an <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="(in Astropy v2.0.1)"><code class="xref py py-obj docutils literal"><span class="pre">WCSAxes</span></code></a> axes, it will by
default plot in pixel coordinates, you can override this behavior and plot in
&#8216;world&#8217; coordinates by getting the transformation from the axes with
<code class="docutils literal"><span class="pre">ax.get_transform('world')</span></code>. Note: World coordinates are always in <strong>degrees</strong>
so you will have to convert to degrees.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smap</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>   
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">100</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span> <span class="p">(</span><span class="mi">500</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">))</span>   
</pre></div>
</div>
<p>Finally, here is a more complex example using SunPy maps, wcsaxes and Astropy
units to plot a AIA image and a zoomed in view of an active region.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">patches</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>

<span class="kn">import</span> <span class="nn">sunpy.map</span>
<span class="kn">import</span> <span class="nn">sunpy.data.sample</span>


<span class="c1"># Define a region of interest</span>
<span class="n">length</span> <span class="o">=</span> <span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>
<span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>
<span class="n">y0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">400</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>

<span class="c1"># Create a SunPy Map, and a second submap over the region of interest.</span>
<span class="n">smap</span> <span class="o">=</span> <span class="n">sunpy</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">sunpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">AIA_171_IMAGE</span><span class="p">)</span>
<span class="n">bottom_left</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">length</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">length</span><span class="p">,</span>
                       <span class="n">frame</span><span class="o">=</span><span class="n">smap</span><span class="o">.</span><span class="n">coordinate_frame</span><span class="p">)</span>
<span class="n">top_right</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">length</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">length</span><span class="p">,</span>
                     <span class="n">frame</span><span class="o">=</span><span class="n">smap</span><span class="o">.</span><span class="n">coordinate_frame</span><span class="p">)</span>
<span class="n">submap</span> <span class="o">=</span> <span class="n">smap</span><span class="o">.</span><span class="n">submap</span><span class="p">(</span><span class="n">bottom_left</span><span class="p">,</span> <span class="n">top_right</span><span class="p">)</span>


<span class="c1"># Create a new matplotlib figure, larger than default.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="c1"># Add a first Axis, using the WCS from the map.</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">smap</span><span class="p">)</span>

<span class="c1"># Plot the Map on the axes with default settings.</span>
<span class="n">smap</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Draw a box on the image</span>
<span class="n">smap</span><span class="o">.</span><span class="n">draw_rectangle</span><span class="p">(</span><span class="n">bottom_left</span><span class="p">,</span> <span class="n">length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create a second axis on the plot.</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">submap</span><span class="p">)</span>

<span class="n">submap</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Add a overlay grid.</span>
<span class="n">submap</span><span class="o">.</span><span class="n">draw_grid</span><span class="p">(</span><span class="n">grid_spacing</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>

<span class="c1"># Change the title.</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Zoomed View&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guide/plotting-7.py">Source code</a>, <a class="reference external" href="../guide/plotting-7.png">png</a>, <a class="reference external" href="../guide/plotting-7.hires.png">hires.png</a>, <a class="reference external" href="../guide/plotting-7.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/plotting-7.png" src="../_images/plotting-7.png" />
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017, The SunPy Community.<br/>
      Last updated on 14 Aug 2017.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>